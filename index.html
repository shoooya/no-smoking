<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¦ç…™ã‚µãƒãƒ¼ãƒˆ - ã‚ãªãŸã®å¥åº·ã¨æœªæ¥ã®ãŸã‚ã«</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .setup-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        .setup-card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            margin-top: 10px;
        }

        .dashboard {
            display: none;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
            margin: 10px 0;
        }

        .stat-label {
            color: #888;
            font-size: 0.9em;
        }

        .milestones-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        .milestones-card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .milestone {
            padding: 20px;
            margin-bottom: 15px;
            border-radius: 15px;
            border-left: 5px solid #e0e0e0;
            background: #f8f9fa;
            transition: all 0.3s;
            position: relative;
        }

        .milestone.achieved {
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
            border-left-color: #28a745;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.2);
        }

        .milestone.next {
            border-left-color: #ffc107;
            background: linear-gradient(135deg, #fff9e6 0%, #ffe8a1 100%);
        }

        .milestone.upcoming {
            border-left-color: #ccc;
            background: #ffffff;
            opacity: 0.9;
        }

        .milestone-status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .milestone.achieved .milestone-status {
            background: #28a745;
            color: white;
        }

        .milestone.next .milestone-status {
            background: #ffc107;
            color: #333;
        }

        .milestone.upcoming .milestone-status {
            background: #e0e0e0;
            color: #666;
        }

        .milestone-time {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 5px;
            font-size: 1.1em;
        }

        .milestone-benefit {
            color: #555;
            line-height: 1.6;
        }

        .milestone-remaining {
            margin-top: 8px;
            color: #888;
            font-size: 0.9em;
            font-style: italic;
        }

        .milestone-icon {
            float: right;
            font-size: 1.5em;
        }

        .achievements-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        .achievements-card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .badges-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
        }

        .badge {
            text-align: center;
            padding: 20px;
            border-radius: 15px;
            background: #f8f9fa;
            opacity: 0.4;
            transition: all 0.3s;
        }

        .badge.earned {
            opacity: 1;
            background: linear-gradient(135deg, #ffd89b 0%, #19547b 100%);
            color: white;
            transform: scale(1);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .badge-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .badge-name {
            font-weight: 600;
            font-size: 0.9em;
        }

        .progress-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        .progress-card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
        }

        .progress-item {
            margin-bottom: 25px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 0.9em;
        }

        .motivation-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            color: white;
            text-align: center;
            margin-bottom: 20px;
        }

        .motivation-card h3 {
            font-size: 1.5em;
            margin-bottom: 15px;
        }

        .motivation-card p {
            font-size: 1.1em;
            line-height: 1.6;
            opacity: 0.95;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8em;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .badges-grid {
                grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            }
        }

        .timer-display {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .timer-display h2 {
            font-size: 1.5em;
            margin-bottom: 20px;
            opacity: 0.9;
        }

        .timer-value {
            font-size: 3em;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .timer-segments {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
        }

        .timer-segment {
            text-align: center;
        }

        .timer-segment-value {
            font-size: 2.5em;
            font-weight: bold;
            display: block;
        }

        .timer-segment-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸš­ ç¦ç…™ã‚µãƒãƒ¼ãƒˆ</h1>
            <p>ã‚ãªãŸã®å¥åº·ã¨æœªæ¥ã®ãŸã‚ã«</p>
        </header>

        <!-- ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç”»é¢ -->
        <div id="setup" class="setup-card">
            <h2>ç¦ç…™ã‚’å§‹ã‚ã¾ã—ã‚‡ã†ï¼</h2>
            <form id="setupForm">
                <div class="form-group">
                    <label for="quitDate">ç¦ç…™é–‹å§‹æ—¥æ™‚</label>
                    <input type="datetime-local" id="quitDate" required>
                </div>
                <div class="form-group">
                    <label for="cigarettesPerDay">1æ—¥ã‚ãŸã‚Šã®å–«ç…™æœ¬æ•°</label>
                    <input type="number" id="cigarettesPerDay" min="1" value="20" required>
                </div>
                <div class="form-group">
                    <label for="pricePerPack">1ç®±ã®ä¾¡æ ¼ï¼ˆå††ï¼‰</label>
                    <input type="number" id="pricePerPack" min="1" value="600" required>
                </div>
                <div class="form-group">
                    <label for="cigarettesPerPack">1ç®±ã‚ãŸã‚Šã®æœ¬æ•°</label>
                    <input type="number" id="cigarettesPerPack" min="1" value="20" required>
                </div>
                <button type="submit" class="btn">ç¦ç…™ã‚’é–‹å§‹ã™ã‚‹</button>
            </form>
        </div>

        <!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ -->
        <div id="dashboard" class="dashboard">
            <!-- ã‚¿ã‚¤ãƒãƒ¼è¡¨ç¤º -->
            <div class="timer-display">
                <h2>ç¦ç…™ç¶™ç¶šæ™‚é–“</h2>
                <div class="timer-segments">
                    <div class="timer-segment">
                        <span class="timer-segment-value" id="days">0</span>
                        <span class="timer-segment-label">æ—¥</span>
                    </div>
                    <div class="timer-segment">
                        <span class="timer-segment-value" id="hours">0</span>
                        <span class="timer-segment-label">æ™‚é–“</span>
                    </div>
                    <div class="timer-segment">
                        <span class="timer-segment-value" id="minutes">0</span>
                        <span class="timer-segment-label">åˆ†</span>
                    </div>
                    <div class="timer-segment">
                        <span class="timer-segment-value" id="seconds">0</span>
                        <span class="timer-segment-label">ç§’</span>
                    </div>
                </div>
            </div>

            <!-- çµ±è¨ˆã‚«ãƒ¼ãƒ‰ -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">ğŸ’°</div>
                    <div class="stat-value" id="moneySaved">Â¥0</div>
                    <div class="stat-label">ç¯€ç´„ã—ãŸé‡‘é¡</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">ğŸš¬</div>
                    <div class="stat-value" id="cigarettesAvoided">0</div>
                    <div class="stat-label">å¸ã‚ãªã‹ã£ãŸã‚¿ãƒã‚³</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">â±ï¸</div>
                    <div class="stat-value" id="lifeRegained">0</div>
                    <div class="stat-label">å–ã‚Šæˆ»ã—ãŸæ™‚é–“ï¼ˆåˆ†ï¼‰</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">â¤ï¸</div>
                    <div class="stat-value" id="healthScore">0%</div>
                    <div class="stat-label">å¥åº·å›å¾©åº¦</div>
                </div>
            </div>

            <!-- ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
            <div class="motivation-card">
                <h3>ä»Šæ—¥ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸</h3>
                <p id="motivationText">ç´ æ™´ã‚‰ã—ã„ï¼ç¦ç…™ã‚’ç¶šã‘ã¦ã„ã¾ã™ã€‚ä¸€æ—¥ä¸€æ—¥ãŒã‚ãªãŸã®å‹åˆ©ã§ã™ï¼</p>
            </div>

            <!-- å¥åº·ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ -->
            <div class="milestones-card">
                <h2>å¥åº·ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³</h2>
                <div id="milestones"></div>
            </div>

            <!-- é€²æ—çŠ¶æ³ -->
            <div class="progress-card">
                <h2>ç›®æ¨™ã¾ã§ã®é€²æ—</h2>
                <div class="progress-item">
                    <div class="progress-label">
                        <span>1é€±é–“é”æˆ</span>
                        <span id="week1Progress">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="week1Bar" style="width: 0%"></div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-label">
                        <span>1ãƒ¶æœˆé”æˆ</span>
                        <span id="month1Progress">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="month1Bar" style="width: 0%"></div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-label">
                        <span>1å¹´é”æˆ</span>
                        <span id="year1Progress">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="year1Bar" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- é”æˆãƒãƒƒã‚¸ -->
            <div class="achievements-card">
                <h2>é”æˆãƒãƒƒã‚¸</h2>
                <div class="badges-grid" id="badges"></div>
            </div>

            <button class="btn btn-secondary" id="resetBtn">ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
        </div>
    </div>

    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let quitData = null;
        let updateInterval = null;

        // å¥åº·ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ï¼ˆåŒ»å­¦çš„æ ¹æ‹ ã«åŸºã¥ãï¼‰
        const healthMilestones = [
            { minutes: 20, text: 'è¡€åœ§ã¨è„ˆæ‹ãŒæ­£å¸¸å€¤ã«æˆ»ã‚Šå§‹ã‚ã¾ã™', icon: 'â¤ï¸' },
            { minutes: 480, text: 'è¡€ä¸­ã®ä¸€é…¸åŒ–ç‚­ç´ æ¿ƒåº¦ãŒæ­£å¸¸å€¤ã«æˆ»ã‚Šã¾ã™', icon: 'ğŸ«' },
            { minutes: 1440, text: 'å¿ƒè‡“ç™ºä½œã®ãƒªã‚¹ã‚¯ãŒæ¸›å°‘ã—å§‹ã‚ã¾ã™', icon: 'ğŸ’“' },
            { minutes: 2880, text: 'å‘³è¦šã¨å—…è¦šãŒå›å¾©ã—å§‹ã‚ã¾ã™', icon: 'ğŸ‘ƒ' },
            { minutes: 10080, text: 'è‚ºæ©Ÿèƒ½ãŒæ”¹å–„ã—ã€å‘¼å¸ãŒæ¥½ã«ãªã‚Šã¾ã™', icon: 'ğŸŒ¬ï¸' },
            { minutes: 43200, text: 'å¾ªç’°å™¨ç³»ãŒå¤§å¹…ã«æ”¹å–„ã•ã‚Œã¾ã™', icon: 'ğŸ©¸' },
            { minutes: 129600, text: 'è‚ºãŒãã‚Œã„ã«ãªã‚Šã€æ„ŸæŸ“ç—‡ã®ãƒªã‚¹ã‚¯ãŒä½ä¸‹ã—ã¾ã™', icon: 'âœ¨' },
            { minutes: 525600, text: 'å¿ƒè‡“ç—…ã®ãƒªã‚¹ã‚¯ãŒåŠæ¸›ã—ã¾ã™', icon: 'ğŸ’ª' },
            { minutes: 2628000, text: 'è‚ºãŒã‚“ç­‰ã®ãƒªã‚¹ã‚¯ãŒå¤§å¹…ã«ä½ä¸‹ã—ã¾ã™', icon: 'ğŸ¯' },
            { minutes: 7884000, text: 'å¥åº·çŠ¶æ…‹ãŒã»ã¼éå–«ç…™è€…ãƒ¬ãƒ™ãƒ«ã«ï¼', icon: 'ğŸ†' }
        ];

        // é”æˆãƒãƒƒã‚¸
        const achievements = [
            { id: 'first-hour', minutes: 60, name: 'æœ€åˆã®1æ™‚é–“', icon: 'â­' },
            { id: 'first-day', minutes: 1440, name: '1æ—¥é”æˆ', icon: 'ğŸŒŸ' },
            { id: 'three-days', minutes: 4320, name: '3æ—¥é”æˆ', icon: 'âœ¨' },
            { id: 'one-week', minutes: 10080, name: '1é€±é–“é”æˆ', icon: 'ğŸ–ï¸' },
            { id: 'two-weeks', minutes: 20160, name: '2é€±é–“é”æˆ', icon: 'ğŸ…' },
            { id: 'one-month', minutes: 43200, name: '1ãƒ¶æœˆé”æˆ', icon: 'ğŸ¥‡' },
            { id: 'three-months', minutes: 129600, name: '3ãƒ¶æœˆé”æˆ', icon: 'ğŸ‘‘' },
            { id: 'six-months', minutes: 259200, name: '6ãƒ¶æœˆé”æˆ', icon: 'ğŸ’' },
            { id: 'one-year', minutes: 525600, name: '1å¹´é”æˆ', icon: 'ğŸ†' },
            { id: 'money-saver', condition: 'money', threshold: 10000, name: 'ç¯€ç´„1ä¸‡å††', icon: 'ğŸ’°' },
            { id: 'big-saver', condition: 'money', threshold: 50000, name: 'ç¯€ç´„5ä¸‡å††', icon: 'ğŸ’µ' },
            { id: 'mega-saver', condition: 'money', threshold: 100000, name: 'ç¯€ç´„10ä¸‡å††', icon: 'ğŸ’´' }
        ];

        // ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
        const motivationMessages = [
            'ç´ æ™´ã‚‰ã—ã„ï¼ã‚ãªãŸã¯å¥åº·ã¸ã®ç¬¬ä¸€æ­©ã‚’è¸ã¿å‡ºã—ã¾ã—ãŸã€‚',
            'ä¸€æœ¬å¸ã‚ãªã„åº¦ã«ã€ã‚ãªãŸã®ä½“ã¯å›å¾©ã—ã¦ã„ã¾ã™ã€‚',
            'ç¦ç…™ã¯æœ€é«˜ã®è‡ªå·±æŠ•è³‡ã§ã™ã€‚ç¶šã‘ã¾ã—ã‚‡ã†ï¼',
            'ã‚ãªãŸã®æ„å¿—ã®å¼·ã•ã¯ç´ æ™´ã‚‰ã—ã„ã§ã™ã€‚',
            'æ¯æ—¥ãŒæ–°ã—ã„å‹åˆ©ã§ã™ã€‚èª‡ã‚Šã«æ€ã£ã¦ãã ã•ã„ï¼',
            'ã‚¿ãƒã‚³ãªã—ã®äººç”Ÿã¯ã€ã‚ˆã‚Šæ˜ã‚‹ãå¥åº·çš„ã§ã™ã€‚',
            'ã‚ãªãŸã¯è‡ªåˆ†ã®å¥åº·ã‚’ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã—ã¦ã„ã¾ã™ã€‚',
            'ç¦ç…™ã®é“ã®ã‚Šã¯ç°¡å˜ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ã‚ãªãŸãªã‚‰ã§ãã¾ã™ï¼',
            'ä»Šæ—¥ã‚‚ç¦ç…™ã‚’ç¶šã‘ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ç´ æ™´ã‚‰ã—ã„ï¼',
            'ã‚ãªãŸã®åŠªåŠ›ã¯ã€å¿…ãšå ±ã‚ã‚Œã¾ã™ã€‚é ‘å¼µã‚Šã¾ã—ã‚‡ã†ï¼'
        ];

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®å‡¦ç†
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            setupEventListeners();

            // ç¾åœ¨æ™‚åˆ»ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¨ã—ã¦è¨­å®š
            const now = new Date();
            now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
            document.getElementById('quitDate').value = now.toISOString().slice(0, 16);
        });

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
        function setupEventListeners() {
            document.getElementById('setupForm').addEventListener('submit', handleSetup);
            document.getElementById('resetBtn').addEventListener('click', handleReset);
        }

        // ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ•ã‚©ãƒ¼ãƒ ã®å‡¦ç†
        function handleSetup(e) {
            e.preventDefault();

            const quitDate = new Date(document.getElementById('quitDate').value);
            const cigarettesPerDay = parseInt(document.getElementById('cigarettesPerDay').value);
            const pricePerPack = parseInt(document.getElementById('pricePerPack').value);
            const cigarettesPerPack = parseInt(document.getElementById('cigarettesPerPack').value);

            quitData = {
                quitDate: quitDate.toISOString(),
                cigarettesPerDay,
                pricePerPack,
                cigarettesPerPack,
                pricePerCigarette: pricePerPack / cigarettesPerPack
            };

            saveData();
            showDashboard();
            startUpdating();
        }

        // ãƒªã‚»ãƒƒãƒˆå‡¦ç†
        function handleReset() {
            if (confirm('æœ¬å½“ã«ãƒ‡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿã“ã‚Œã¾ã§ã®è¨˜éŒ²ã¯å…¨ã¦å‰Šé™¤ã•ã‚Œã¾ã™ã€‚')) {
                localStorage.removeItem('quitData');
                quitData = null;
                if (updateInterval) {
                    clearInterval(updateInterval);
                }
                showSetup();
            }
        }

        // ãƒ‡ãƒ¼ã‚¿ã®ä¿å­˜
        function saveData() {
            localStorage.setItem('quitData', JSON.stringify(quitData));
        }

        // ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
        function loadData() {
            const saved = localStorage.getItem('quitData');
            if (saved) {
                quitData = JSON.parse(saved);
                showDashboard();
                startUpdating();
            } else {
                showSetup();
            }
        }

        // ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ç”»é¢ã‚’è¡¨ç¤º
        function showSetup() {
            document.getElementById('setup').classList.remove('hidden');
            document.getElementById('dashboard').classList.add('hidden');
            document.getElementById('dashboard').style.display = 'none';
        }

        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’è¡¨ç¤º
        function showDashboard() {
            document.getElementById('setup').classList.add('hidden');
            document.getElementById('setup').style.display = 'none';
            document.getElementById('dashboard').classList.remove('hidden');
            document.getElementById('dashboard').style.display = 'block';
        }

        // å®šæœŸæ›´æ–°ã®é–‹å§‹
        function startUpdating() {
            updateDashboard();
            updateInterval = setInterval(updateDashboard, 1000);
        }

        // ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®æ›´æ–°
        function updateDashboard() {
            const now = new Date();
            const quitDate = new Date(quitData.quitDate);
            const diffMs = now - quitDate;

            if (diffMs < 0) {
                return; // æœªæ¥ã®æ—¥ä»˜ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹å ´åˆ
            }

            const diffMinutes = Math.floor(diffMs / 60000);
            const diffSeconds = Math.floor(diffMs / 1000);

            // æ™‚é–“ã®è¨ˆç®—
            const days = Math.floor(diffMinutes / 1440);
            const hours = Math.floor((diffMinutes % 1440) / 60);
            const minutes = diffMinutes % 60;
            const seconds = diffSeconds % 60;

            // ã‚¿ã‚¤ãƒãƒ¼è¡¨ç¤ºã®æ›´æ–°
            document.getElementById('days').textContent = days;
            document.getElementById('hours').textContent = hours;
            document.getElementById('minutes').textContent = minutes;
            document.getElementById('seconds').textContent = seconds;

            // çµ±è¨ˆã®è¨ˆç®—
            const cigarettesAvoided = Math.floor((diffMinutes / 1440) * quitData.cigarettesPerDay);
            const moneySaved = Math.floor(cigarettesAvoided * quitData.pricePerCigarette);
            const lifeRegained = cigarettesAvoided * 11; // 1æœ¬ã‚ãŸã‚Š11åˆ†å¯¿å‘½ãŒç¸®ã‚€ã¨ã•ã‚Œã‚‹

            // å¥åº·ã‚¹ã‚³ã‚¢ã®è¨ˆç®—ï¼ˆ15å¹´ã§100%ï¼‰
            const healthScore = Math.min(100, Math.floor((diffMinutes / 7884000) * 100));

            // çµ±è¨ˆã®è¡¨ç¤º
            document.getElementById('moneySaved').textContent = `Â¥${moneySaved.toLocaleString()}`;
            document.getElementById('cigarettesAvoided').textContent = cigarettesAvoided.toLocaleString();
            document.getElementById('lifeRegained').textContent = lifeRegained.toLocaleString();
            document.getElementById('healthScore').textContent = `${healthScore}%`;

            // ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ã®æ›´æ–°
            updateMilestones(diffMinutes);

            // ãƒãƒƒã‚¸ã®æ›´æ–°
            updateBadges(diffMinutes, moneySaved);

            // é€²æ—ãƒãƒ¼ã®æ›´æ–°
            updateProgress(diffMinutes);

            // ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ›´æ–°ï¼ˆ1æ—¥ã”ã¨ã«å¤‰æ›´ï¼‰
            const messageIndex = days % motivationMessages.length;
            document.getElementById('motivationText').textContent = motivationMessages[messageIndex];
        }

        // ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ã®æ›´æ–°
        function updateMilestones(currentMinutes) {
            const milestonesContainer = document.getElementById('milestones');
            milestonesContainer.innerHTML = '';

            let nextMilestoneFound = false;

            healthMilestones.forEach(milestone => {
                const div = document.createElement('div');
                div.className = 'milestone';

                let statusText = '';
                let statusClass = '';
                let remainingText = '';

                if (currentMinutes >= milestone.minutes) {
                    div.classList.add('achieved');
                    statusText = 'é”æˆæ¸ˆã¿ âœ“';
                    statusClass = 'milestone-status';
                } else if (!nextMilestoneFound) {
                    div.classList.add('next');
                    statusText = 'æ¬¡ã®ç›®æ¨™ â†’';
                    statusClass = 'milestone-status';
                    nextMilestoneFound = true;

                    // æ®‹ã‚Šæ™‚é–“ã‚’è¨ˆç®—
                    const remainingMinutes = milestone.minutes - currentMinutes;
                    remainingText = `<div class="milestone-remaining">ã‚ã¨ ${formatRemainingTime(remainingMinutes)}</div>`;
                } else {
                    div.classList.add('upcoming');
                    statusText = 'æœªé”æˆ';
                    statusClass = 'milestone-status';

                    // æ®‹ã‚Šæ™‚é–“ã‚’è¨ˆç®—
                    const remainingMinutes = milestone.minutes - currentMinutes;
                    remainingText = `<div class="milestone-remaining">ã‚ã¨ ${formatRemainingTime(remainingMinutes)}</div>`;
                }

                const timeText = formatMilestoneTime(milestone.minutes);

                div.innerHTML = `
                    <span class="milestone-icon">${milestone.icon}</span>
                    <div class="${statusClass}">${statusText}</div>
                    <div class="milestone-time">${timeText}</div>
                    <div class="milestone-benefit">${milestone.text}</div>
                    ${remainingText}
                `;

                milestonesContainer.appendChild(div);
            });
        }

        // æ®‹ã‚Šæ™‚é–“ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        function formatRemainingTime(minutes) {
            if (minutes < 60) {
                return `${minutes}åˆ†`;
            } else if (minutes < 1440) {
                const hours = Math.floor(minutes / 60);
                const mins = minutes % 60;
                return mins > 0 ? `${hours}æ™‚é–“${mins}åˆ†` : `${hours}æ™‚é–“`;
            } else if (minutes < 43200) {
                const days = Math.floor(minutes / 1440);
                const hours = Math.floor((minutes % 1440) / 60);
                return hours > 0 ? `${days}æ—¥${hours}æ™‚é–“` : `${days}æ—¥`;
            } else if (minutes < 525600) {
                const months = Math.floor(minutes / 43200);
                const days = Math.floor((minutes % 43200) / 1440);
                return days > 0 ? `${months}ãƒ¶æœˆ${days}æ—¥` : `${months}ãƒ¶æœˆ`;
            } else {
                const years = Math.floor(minutes / 525600);
                const months = Math.floor((minutes % 525600) / 43200);
                return months > 0 ? `${years}å¹´${months}ãƒ¶æœˆ` : `${years}å¹´`;
            }
        }

        // ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³æ™‚é–“ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
        function formatMilestoneTime(minutes) {
            if (minutes < 60) {
                return `${minutes}åˆ†`;
            } else if (minutes < 1440) {
                return `${Math.floor(minutes / 60)}æ™‚é–“`;
            } else if (minutes < 43200) {
                return `${Math.floor(minutes / 1440)}æ—¥`;
            } else if (minutes < 525600) {
                return `${Math.floor(minutes / 43200)}ãƒ¶æœˆ`;
            } else {
                return `${Math.floor(minutes / 525600)}å¹´`;
            }
        }

        // ãƒãƒƒã‚¸ã®æ›´æ–°
        function updateBadges(currentMinutes, moneySaved) {
            const badgesContainer = document.getElementById('badges');
            badgesContainer.innerHTML = '';

            achievements.forEach(achievement => {
                const div = document.createElement('div');
                div.className = 'badge';

                let earned = false;
                if (achievement.condition === 'money') {
                    earned = moneySaved >= achievement.threshold;
                } else {
                    earned = currentMinutes >= achievement.minutes;
                }

                if (earned) {
                    div.classList.add('earned');
                }

                div.innerHTML = `
                    <div class="badge-icon">${achievement.icon}</div>
                    <div class="badge-name">${achievement.name}</div>
                `;

                badgesContainer.appendChild(div);
            });
        }

        // é€²æ—ãƒãƒ¼ã®æ›´æ–°
        function updateProgress(currentMinutes) {
            // 1é€±é–“ï¼ˆ10080åˆ†ï¼‰
            const week1Percent = Math.min(100, Math.floor((currentMinutes / 10080) * 100));
            document.getElementById('week1Progress').textContent = `${week1Percent}%`;
            document.getElementById('week1Bar').style.width = `${week1Percent}%`;
            document.getElementById('week1Bar').textContent = week1Percent > 0 ? `${week1Percent}%` : '';

            // 1ãƒ¶æœˆï¼ˆ43200åˆ†ï¼‰
            const month1Percent = Math.min(100, Math.floor((currentMinutes / 43200) * 100));
            document.getElementById('month1Progress').textContent = `${month1Percent}%`;
            document.getElementById('month1Bar').style.width = `${month1Percent}%`;
            document.getElementById('month1Bar').textContent = month1Percent > 0 ? `${month1Percent}%` : '';

            // 1å¹´ï¼ˆ525600åˆ†ï¼‰
            const year1Percent = Math.min(100, Math.floor((currentMinutes / 525600) * 100));
            document.getElementById('year1Progress').textContent = `${year1Percent}%`;
            document.getElementById('year1Bar').style.width = `${year1Percent}%`;
            document.getElementById('year1Bar').textContent = year1Percent > 0 ? `${year1Percent}%` : '';
        }
    </script>
</body>
</html>
