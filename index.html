<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>禁煙サポート - あなたの健康と未来のために</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>🚭 禁煙サポート</h1>
            <p>あなたの健康と未来のために</p>
        </header>

        <!-- セットアップ画面 -->
        <div id="setup" class="setup-card">
            <h2>禁煙を始めましょう！</h2>
            <form id="setupForm">
                <div class="form-group">
                    <label for="quitDate">禁煙開始日時</label>
                    <input type="datetime-local" id="quitDate" required>
                </div>
                <div class="form-group">
                    <label for="cigarettesPerDay">1日あたりの喫煙本数</label>
                    <input type="number" id="cigarettesPerDay" min="1" value="20" required>
                </div>
                <div class="form-group">
                    <label for="pricePerPack">1箱の価格（円）</label>
                    <input type="number" id="pricePerPack" min="1" value="600" required>
                </div>
                <div class="form-group">
                    <label for="cigarettesPerPack">1箱あたりの本数</label>
                    <input type="number" id="cigarettesPerPack" min="1" value="20" required>
                </div>
                <button type="submit" class="btn">禁煙を開始する</button>
            </form>
        </div>

        <!-- ダッシュボード -->
        <div id="dashboard" class="dashboard">
            <!-- タイマー表示 -->
            <div class="timer-display">
                <h2>最後に吸ってからの経過時間</h2>
                <div class="timer-segments">
                    <div class="timer-segment">
                        <span class="timer-segment-value" id="slipDays">0</span>
                        <span class="timer-segment-label">日</span>
                    </div>
                    <div class="timer-segment">
                        <span class="timer-segment-value" id="slipHours">0</span>
                        <span class="timer-segment-label">時間</span>
                    </div>
                    <div class="timer-segment">
                        <span class="timer-segment-value" id="slipMinutes">0</span>
                        <span class="timer-segment-label">分</span>
                    </div>
                    <div class="timer-segment">
                        <span class="timer-segment-value" id="slipSeconds">0</span>
                        <span class="timer-segment-label">秒</span>
                    </div>
                </div>

                <!-- 開始からの経過時間（小さめ表示） -->
                <div class="timer-secondary">
                    <div class="timer-secondary-label">禁煙開始からの経過:</div>
                    <div class="timer-secondary-segments">
                        <span><span id="startDays">0</span>日</span>
                        <span><span id="startHours">0</span>時間</span>
                        <span><span id="startMinutes">0</span>分</span>
                        <span><span id="startSeconds">0</span>秒</span>
                    </div>
                </div>
            </div>

            <!-- 禁煙継続カレンダー -->
            <div class="calendar-card">
                <h2>禁煙継続カレンダー</h2>
                <div id="calendarHeatmap" class="calendar-heatmap"></div>
                <div class="calendar-legend">
                    <div class="calendar-legend-item">
                        <div class="calendar-legend-box" style="background: #f8f9fa; border: 1px dashed #e0e0e0;"></div>
                        <span>未到達</span>
                    </div>
                    <div class="calendar-legend-item">
                        <div class="calendar-legend-box" style="background: #84fab0;"></div>
                        <span>継続中</span>
                    </div>
                    <div class="calendar-legend-item">
                        <div class="calendar-legend-box" style="background: #28a745;"></div>
                        <span>完璧な1日</span>
                    </div>
                    <div class="calendar-legend-item">
                        <div class="calendar-legend-box" style="background: #ffc107;"></div>
                        <span>渇望あり</span>
                    </div>
                    <div class="calendar-legend-item">
                        <div class="calendar-legend-box" style="background: #dc3545;"></div>
                        <span>スリップ</span>
                    </div>
                </div>
            </div>
            <div class="calendar-tooltip" id="calendarTooltip"></div>

            <!-- 統計カード -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">💰</div>
                    <div class="stat-value" id="moneySaved">¥0</div>
                    <div class="stat-label">節約した金額</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">🚬</div>
                    <div class="stat-value" id="cigarettesAvoided">0</div>
                    <div class="stat-label">吸わなかったタバコ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">⏱️</div>
                    <div class="stat-value" id="lifeRegained">0</div>
                    <div class="stat-label">取り戻した時間（分）</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">❤️</div>
                    <div class="stat-value" id="healthScore">0%</div>
                    <div class="stat-label">健康回復度</div>
                </div>
            </div>

            <!-- 購入シミュレーター -->
            <div class="purchase-simulator-card">
                <h2>節約金額で買えるもの</h2>
                <div class="purchase-grid" id="purchaseGrid"></div>
            </div>

            <!-- なぜ禁煙？リマインダー -->
            <div class="why-quit-card">
                <h2>💪 なぜ禁煙？</h2>
                <div class="reason-list" id="reasonList"></div>
                <button class="add-reason-btn" id="addReasonBtn">+ 理由を追加</button>
            </div>

            <!-- モチベーションメッセージ -->
            <div class="motivation-card">
                <h3>今日のメッセージ</h3>
                <p id="motivationText">素晴らしい！禁煙を続けています。一日一日があなたの勝利です！</p>
            </div>

            <!-- 健康マイルストーン -->
            <div class="milestones-card">
                <h2>健康マイルストーン</h2>
                <div id="milestones"></div>
            </div>

            <!-- 進捗状況 -->
            <div class="progress-card">
                <h2>目標までの進捗</h2>
                <div class="progress-item">
                    <div class="progress-label">
                        <span>1週間達成</span>
                        <span id="week1Progress">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="week1Bar" style="width: 0%"></div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-label">
                        <span>1ヶ月達成</span>
                        <span id="month1Progress">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="month1Bar" style="width: 0%"></div>
                    </div>
                </div>
                <div class="progress-item">
                    <div class="progress-label">
                        <span>1年達成</span>
                        <span id="year1Progress">0%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="year1Bar" style="width: 0%"></div>
                    </div>
                </div>
            </div>

            <!-- 達成バッジ -->
            <div class="achievements-card">
                <h2>達成バッジ</h2>
                <div class="badges-grid" id="badges"></div>
            </div>

            <!-- 対処法データベース -->
            <div class="coping-strategies-card">
                <h2>対処法データベース</h2>
                <div class="strategy-categories">
                    <button class="category-filter active" data-category="all">すべて</button>
                    <button class="category-filter" data-category="即効性">即効性（1-5分）</button>
                    <button class="category-filter" data-category="中期対策">中期対策（10-30分）</button>
                    <button class="category-filter" data-category="長期戦略">長期戦略</button>
                    <button class="category-filter" data-category="favorite">お気に入り</button>
                </div>
                <div class="strategy-grid" id="strategyGrid"></div>
            </div>

            <!-- 渇望記録一覧 -->
            <div class="cravings-card">
                <h2>渇望記録</h2>
                <div class="craving-stats" id="cravingStats">
                    <div class="craving-stat-box">
                        <div class="craving-stat-value" id="totalCravings">0</div>
                        <div class="craving-stat-label">総渇望回数</div>
                    </div>
                    <div class="craving-stat-box">
                        <div class="craving-stat-value" id="avgIntensity">0</div>
                        <div class="craving-stat-label">平均強度</div>
                    </div>
                    <div class="craving-stat-box">
                        <div class="craving-stat-value" id="todayCravings">0</div>
                        <div class="craving-stat-label">今日の渇望</div>
                    </div>
                </div>
                <div id="cravingsList"></div>
            </div>

            <!-- 吸っちゃった記録一覧 -->
            <div class="slips-card">
                <h2>吸っちゃった記録</h2>
                <div class="slip-stats" id="slipStats">
                    <div class="slip-stat-box">
                        <div class="slip-stat-value" id="totalSlips">0</div>
                        <div class="slip-stat-label">総記録回数</div>
                    </div>
                    <div class="slip-stat-box">
                        <div class="slip-stat-value" id="totalSlipCigarettes">0</div>
                        <div class="slip-stat-label">総本数</div>
                    </div>
                </div>
                <div id="slipsList"></div>
            </div>

            <button class="btn" id="shareBtn">🔗 進捗を共有するURLをコピー</button>
            <button class="btn btn-secondary" id="resetBtn">データをリセット</button>
        </div>
    </div>

    <!-- 渇望記録FABボタン -->
    <button class="fab-button hidden" id="cravingFab" title="吸いたくなった">🚬</button>

    <!-- 吸っちゃった記録ボタン -->
    <button class="slip-button hidden" id="slipButton" title="吸っちゃった">💔</button>

    <!-- 緊急SOSボタン -->
    <button class="sos-button hidden" id="sosButton" title="緊急SOS">🆘</button>

    <!-- 緊急SOSオーバーレイ -->
    <div class="sos-overlay" id="sosOverlay">
        <div class="sos-content">
            <div class="sos-title">🚨 ちょっと待って！</div>
            <div class="sos-message" id="sosMessage"></div>
            <div class="sos-stats" id="sosStats"></div>
            <div class="sos-countdown" id="sosCountdown">5:00</div>
            <div class="sos-actions">
                <button class="sos-action-btn" onclick="alert('深呼吸：4秒吸って、7秒止めて、8秒吐く')">🫁 深呼吸する</button>
                <button class="sos-action-btn" onclick="alert('水を飲みましょう！')">💧 水を飲む</button>
                <button class="sos-action-btn" onclick="alert('短い散歩に行きましょう')">🚶 散歩する</button>
            </div>
            <button class="sos-action-btn sos-overcome-btn" id="sosOvercomeBtn">✓ 乗り越えた！</button>
        </div>
    </div>

    <!-- 渇望記録モーダル -->
    <div class="modal-overlay" id="cravingModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>渇望を記録</h2>
                <button class="modal-close" id="closeCravingModal">×</button>
            </div>
            <form id="cravingForm">
                <div class="form-group">
                    <label>渇望の強さ（1-10）</label>
                    <div class="intensity-slider-container">
                        <input type="range" class="intensity-slider" id="intensitySlider" min="1" max="10" value="5">
                        <div class="intensity-value" id="intensityValue">5</div>
                    </div>
                </div>

                <div class="form-group">
                    <label>状況</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="sit1" name="situation" value="仕事中" checked>
                            <label for="sit1">仕事中</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="sit2" name="situation" value="食後">
                            <label for="sit2">食後</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="sit3" name="situation" value="飲酒時">
                            <label for="sit3">飲酒時</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="sit4" name="situation" value="ストレス">
                            <label for="sit4">ストレス</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="sit5" name="situation" value="その他">
                            <label for="sit5">その他</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="cravingTrigger">トリガー</label>
                    <input type="text" id="cravingTrigger" placeholder="何がきっかけですか？">
                </div>

                <div class="form-group">
                    <label for="cravingNotes">メモ（任意）</label>
                    <input type="text" id="cravingNotes" placeholder="気持ちや状況を記録...">
                </div>

                <button type="submit" class="btn">記録する</button>
            </form>
        </div>
    </div>

    <!-- 吸っちゃった記録モーダル -->
    <div class="modal-overlay" id="slipModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>吸っちゃった記録</h2>
                <button class="modal-close" id="closeSlipModal">×</button>
            </div>
            <form id="slipForm">
                <div class="form-group">
                    <label>本数</label>
                    <div class="intensity-slider-container">
                        <input type="range" class="intensity-slider" id="slipCountSlider" min="1" max="20" value="1">
                        <div class="intensity-value" id="slipCountValue">1</div>
                    </div>
                </div>

                <div class="form-group">
                    <label>状況</label>
                    <div class="radio-group">
                        <div class="radio-option">
                            <input type="radio" id="slipSit1" name="slipSituation" value="仕事中" checked>
                            <label for="slipSit1">仕事中</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="slipSit2" name="slipSituation" value="食後">
                            <label for="slipSit2">食後</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="slipSit3" name="slipSituation" value="飲酒時">
                            <label for="slipSit3">飲酒時</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="slipSit4" name="slipSituation" value="ストレス">
                            <label for="slipSit4">ストレス</label>
                        </div>
                        <div class="radio-option">
                            <input type="radio" id="slipSit5" name="slipSituation" value="その他">
                            <label for="slipSit5">その他</label>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="slipTrigger">何がきっかけでしたか？</label>
                    <input type="text" id="slipTrigger" placeholder="例：飲み会で周りの人が吸っていた">
                </div>

                <div class="form-group">
                    <label for="slipFeelings">気持ち（任意）</label>
                    <input type="text" id="slipFeelings" placeholder="今の気持ちを記録...">
                </div>

                <button type="submit" class="btn">記録する</button>
            </form>
        </div>
    </div>

    <!-- JavaScript Modules -->
    <script src="js/state.js"></script>
    <script src="js/data.js"></script>
    <script src="js/storage.js"></script>
    <script src="js/sharing.js"></script>
    <script src="js/calendar.js"></script>
    <script src="js/cravings.js"></script>
    <script src="js/slips.js"></script>
    <script src="js/strategies.js"></script>
    <script src="js/sos.js"></script>
    <script src="js/reasons.js"></script>
    <script src="js/progress.js"></script>
    <script src="js/timer.js"></script>
    <script src="js/setup.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
